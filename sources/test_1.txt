insert into hdm_wbd_zx_qry_tblpbocloancardinfo_cue( row_id , global_type , global_id , customer_name , sharecreditlimitamount , usedcreditlimitamount , latest6monthusedavgamount , usedhighestamount , scheduledpaymentamount , scheduledpaymentdate , actualpaymentamount , recentpaydate , curroverduecyc , curroverdueamount , last_24state , cue , cue_out_time , cue_org, cue_cust_type , cue_no , cue_db_way , cue_sx_amount , cue_end_time , state , loan_card_id , etl_dt , data_dt ) select t.row_id , t.global_type , t.global_id , t.customer_name , replace(t.sharecreditlimitamount,'\N',0) as sharecreditlimitamount , replace(t.usedcreditlimitamount,'\N',0) as usedcreditlimitamount , replace(t.latest6monthusedavgamount,'\N',0) as latest6monthusedavgamount , replace(t.usedhighestamount,'\N',0) as usedhighestamount , replace(t.scheduledpaymentamount,'\N',0) as scheduledpaymentamount , t.scheduledpaymentdate , replace(t.actualpaymentamount,'\N',0) as actualpaymentamount , t.recentpaydate , replace(t.curroverduecyc,'\N',0) as curroverduecyc , replace(t.curroverdueamount,'\N',0) as curroverdueamount , replace(t.last_24state,'\N',0) as last_24state , replace(t.cue,'\N',0) as cue , replace(replace(replace(regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'\.([0-9].*?日)'),'年',''),'月',''),'日','') as cue_out_time , regexp_substr(replace(replace(replace(replace(replace(cue,' ',''),' ',''),',',''),'“',''),'”',''),'日商业银行(.*)发放') as cue_org , regexp_substr(replace(replace(replace(replace(replace(cue,' ',''),' ',''),',',''),'“',''),'”',''),'卡（(.*)），') as cue_cust_type , regexp_substr(replace(replace(replace(replace(replace(cue,' ',''),' ',''),',',''),'“',''),'”',''),'业务号(.*)，授信') as cue_no , regexp_substr(replace(replace(replace(replace(replace(substr(cue,regexp_instr(cue,'，','1','4')+1),' ',''),' ',''),',',''),'，',''),'。',''),'(.*)截至') as cue_db_way , regexp_substr(replace(replace(replace(cue,' ',''),'折合人民币',''),',',''),'授信额度*([0-9]+)') as cue_sx_amount , replace(replace(replace(regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'截至([0-9].*?日)'),'年',''),'月',''),'日','') as cue_end_time, t.state , replace(t.loan_card_id,'\N',0) as loan_card_id , '' AS etl_dt , t.data_dt from (SELECT A.REPORT_SN AS row_id , A.CERT_TYPE AS global_type , A.CERT_NO AS global_id , A.NAME AS customer_name , B.sharecreditlimitamount , B.usedcreditlimitamount , B.latest6monthusedavgamount , B.usedhighestamount , B.scheduledpaymentamount , B.scheduledpaymentdate , B.actualpaymentamount , B.recentpaydate , B.curroverduecyc , B.curroverdueamount , B.last_24state , B.cue , B.state , B.loan_card_id , A.QUERY_TIME AS data_dt FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A LEFT JOIN TBL_PER_LOAN_CARD_INFO B ON A.REPORT_SN = B.REPORT_ID ) T ; 
insert into hdm_wbd_zx_qry_tblpbocloaninfo_cue( row_id , global_type , global_id , customer_name , class5state , balance , remainpaymentcyc , scheduledpaymentamount , scheduledpaymentdate , actualpaymentamount , recentpaydate , curroverduecyc , curroverdueamount , overdue31to60amount , overdue61to90amount , overdue91to180amount , overdueover180amount , latest24state , cue , cue_out_time , cue_org , cue_amt , cue_bz , cue_amt_zl , cue_no , cue_db_way , cue_qs , cue_gh_way , cue_end_time , state , loan_id , etl_dt , data_dt ) select t.row_id , t.global_type , t.global_id , t.customer_name , replace(t.class5state,'\N','') as class5state , replace(t.balance,'\N','0') as balance , replace(t.remainpaymentcyc,'\N','0') as remainpaymentcyc , replace(t.scheduledpaymentamount,'\N','0') as scheduledpaymentamount , replace(t.scheduledpaymentdate,'\N','') as scheduledpaymentdate , replace(t.actualpaymentamount,'\N','') as actualpaymentamount , replace(t.recentpaydate ,'\N','') as recentpaydate , replace(t.curroverduecyc ,'\N','') as curroverduecyc , replace(t.curroverdueamount ,'\N','0') as curroverdueamount , replace(t.overdue31to60amount ,'\N','0') as overdue31to60amount , replace(t.overdue61to90amount,'\N','0') as overdue61to90amount , replace(t.overdue91to180amount,'\N','0') as overdue91to180amount , replace(t.overdueover180amount,'\N','0') as overdueover180amount , replace(t.latest24state,'\N','') as latest24state , t.cue , replace(replace(replace(regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'\.([0-9].*?日)'),'年',''),'月',''),'日','') as cue_out_time , coalesce( regexp_substr(replace(replace(replace(substr(t.cue,1,regexp_instr(t.cue,'，')),' ',''),' ',''),',',''),'“(.*)”发放'), regexp_substr(replace(replace(replace(substr(t.cue,1,regexp_instr(t.cue,'，')),' ',''),' ',''),',',''),'银行(.*)发放'), regexp_substr(replace(replace(replace(substr(t.cue,1,regexp_instr(t.cue,'，')),' ',''),' ',''),',',''),'公司(.*)发放'), regexp_substr(replace(replace(replace(substr(t.cue,1,regexp_instr(t.cue,'，')),' ',''),' ',''),',',''),'机构(.*)发放'), regexp_substr(replace(replace(replace(substr(t.cue,1,regexp_instr(t.cue,'，')),' ',''),' ',''),',',''),'中心(.*)发放') ) as cue_org , regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'发放的*([0-9]+)') as cue_amt, replace(regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'元（(.*?）)'),'）','') as cue_bz, replace(regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'）(.*?，)'),'，','') as cue_amt_zl, replace(regexp_substr(replace(replace(cue,' ',''),' ',''),'业务号(.*?，)'),'，','') as cue_no, replace(regexp_substr(replace(replace(substr(t.cue,regexp_instr(t.cue,'，',1,2)+1),' ',''),' ',''),'(.*?，)'),'，','') as cue_db_way , replace(regexp_substr(replace(replace(substr(t.cue,regexp_instr(t.cue,'，',1,3)+1),' ',''),' ',''),'(.*?期，)'),'，','') as cue_qs , replace(regexp_substr(replace(replace(substr(t.cue,regexp_instr(t.cue,'，',1,3)+1),' ',''),' ',''),'(.*?截至)'),'截至','') as cue_gh_way , replace(replace(replace(regexp_substr(replace(replace(replace(t.cue,' ',''),' ',''),',',''),'截至([0-9].*?日)'),'年',''),'月',''),'日','') as cue_end_time, t.state , replace(t.loan_id,'\N',0) as loan_id , '' AS etl_dt , t.data_dt from (SELECT A.REPORT_SN AS row_id , A.CERT_TYPE AS global_type , A.CERT_NO AS global_id , A.NAME AS customer_name , B.class5state , B.balance , B.remainpaymentcyc , B.scheduledpaymentamount , B.scheduledpaymentdate , B.actualpaymentamount , B.recentpaydate , B.curroverduecyc , B.curroverdueamount , B.overdue31to60amount , B.overdue61to90amount , B.overdue91to180amount , B.overdueover180amount , B.LAST24MONTHBEGINMONTH AS latest24state , B.cue , B.state , B.loan_id , A.QUERY_TIME AS data_dt FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A LEFT JOIN TBL_PER_LOAN_INFO B ON A.REPORT_SN = B.REPORT_ID WHERE B.STATE <>'结清' ) T ; 
insert into hdm_wbd_zx_qry_tblpbocloancardinfo_all ( row_id , global_type , global_id , customer_name , sharecreditlimitamount , usedcreditlimitamount , latest6monthusedavgamount , usedhighestamount , scheduledpaymentamount , scheduledpaymentdate , actualpaymentamount , recentpaydate , curroverduecyc , curroverdueamount , last_24state , cue, cue_out_time, cue_org, cue_card_type , cue_cust_type, cue_no, cue_db_way, cue_sx_amount, cue_sx_share_amount , cue_end_time, query_time, querydate, queryreason, querier, state , loan_card_id , etl_dt , data_dt ) select t1.row_id , t1.global_type , t1.global_id , t1.customer_name , replace(t1.sharecreditlimitamount,'\N',0) as sharecreditlimitamount , replace(t1.usedcreditlimitamount,'\N',0) as usedcreditlimitamount , replace(t1.latest6monthusedavgamount,'\N',0) as latest6monthusedavgamount , replace(t1.usedhighestamount,'\N',0) as usedhighestamount , replace(t1.scheduledpaymentamount,'\N',0) as scheduledpaymentamount , replace(t1.scheduledpaymentdate,'\N','') as scheduledpaymentdate , replace(t1.actualpaymentamount,'\N',0) as actualpaymentamount , replace(t1.recentpaydate,'\N','') as recentpaydate , replace(t1.curroverduecyc,'\N',0) as curroverduecyc , replace(t1.curroverdueamount,'\N',0) as curroverdueamount , replace(t1.last_24state,'\N',0) as last_24state , replace(t1.cue,'\N',0) as cue , replace(replace(replace(regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'\.([0-9].*?日)'),'年',''),'月',''),'日','') as cue_out_time , regexp_substr(replace(replace(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'“',''),'”',''),'日商业银行(.*)发放') as cue_org , case when t1.cue is not null then regexp_substr(replace(replace(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'“',''),'”',''),'发放的(.*)卡') ||'卡' else null end as cue_card_type , regexp_substr(replace(replace(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'“',''),'”',''),'卡（(.*)），') as cue_cust_type , regexp_substr(replace(replace(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'“',''),'”',''),'业务号(.*)，授信') as cue_no , regexp_substr(replace(replace(replace(replace(replace(substr(t1.cue,regexp_instr(t1.cue,'，','1','4')+1),' ',''),' ',''),',',''),'，',''),'。',''),'(.*)截至') as cue_db_way , regexp_substr(replace(replace(replace(t1.cue,' ',''),'折合人民币',''),',',''),'授信额度*([0-9]+)') as cue_sx_amount , regexp_substr(replace(replace(replace(t1.cue,' ',''),'折合人民币',''),',',''),'共享授信额度*([0-9]+)') as cue_sx_share_amount , replace(replace(replace(regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'截至([0-9].*?日)'),'年',''),'月',''),'日','') as cue_end_time, t.query_time , t2.querydate , t2.queryreason , t2.querier , t1.state , replace(t1.loan_card_id,'\N',0) as loan_card_id , '' AS etl_dt , t1.data_dt from (select B.report_sn ,B.global_id,max(replace(replace(substr(B.query_time,1,10),'.',''),'\N','')) as query_time from (SELECT A.CERT_NO AS global_id , A.report_sn , A.query_time FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A ) B group by B.report_sn ,B.global_id ) T left join (SELECT A1.REPORT_SN AS row_id , A1.CERT_TYPE AS global_type , A1.CERT_NO AS global_id , A1.REPORT_SN , A1.NAME AS customer_name , B1.sharecreditlimitamount , B1.usedcreditlimitamount , B1.latest6monthusedavgamount , B1.usedhighestamount , B1.scheduledpaymentamount , B1.scheduledpaymentdate , B1.actualpaymentamount , B1.recentpaydate , B1.curroverduecyc , B1.curroverdueamount , B1.last_24state , B1.cue , B1.state , B1.loan_card_id , A1.QUERY_TIME AS data_dt FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A1 LEFT JOIN TBL_PER_LOAN_CARD_INFO B1 ON A1.REPORT_SN = B1.REPORT_ID ) T1 on t.report_sn = t1.row_id left join (SELECT A.CERT_NO AS global_id , B2.report_id , replace(replace(substr(B2.querydate,1,10),'.',''),'\N','') as querydate , replace(B2.queryreason,'\N','') as queryreason , replace(B2.querier,'\N','') as querier FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A LEFT JOIN (SELECT TT1.* FROM (SELECT TT.* , ROW_NUMBER() over(PARTITION BY TT.REPORT_ID ORDER BY TT.querydate DESC ) sq FROM TBL_PER_RECORDDETAIL TT ) TT1 WHERE TT1.sq=1 ) B2 ON A.REPORT_SN = B2.REPORT_ID ) t2 on t.report_sn=t2.report_id where t.report_sn is not null ; 
insert into hdm_wbd_zx_qry_tblpbocloaninfo_all ( row_id , global_type , global_id , customer_name , class5state , balance , remainpaymentcyc , scheduledpaymentamount , scheduledpaymentdate , actualpaymentamount , recentpaydate , curroverduecyc , curroverdueamount , overdue31to60amount , overdue61to90amount , overdue91to180amount , overdueover180amount , latest24state , cue , cue_out_time , cue_org , cue_amt , cue_bz , cue_amt_zl , cue_no , cue_db_way , cue_qs , cue_gh_way , cue_end_time , query_time, querydate, queryreason, querier, state , loan_id , etl_dt , data_dt ) select t1.row_id , t1.global_type , t1.global_id , t1.customer_name , replace(t1.class5state,'\N','') as class5state , replace(t1.balance,'\N','0') as balance , replace(t1.remainpaymentcyc,'\N','0') as remainpaymentcyc , replace(t1.scheduledpaymentamount,'\N','0') as scheduledpaymentamount , replace(t1.scheduledpaymentdate,'\N','') as scheduledpaymentdate , replace(t1.actualpaymentamount,'\N','') as actualpaymentamount , replace(t1.recentpaydate ,'\N','') as recentpaydate , replace(t1.curroverduecyc ,'\N','') as curroverduecyc , replace(t1.curroverdueamount ,'\N','0') as curroverdueamount , replace(t1.overdue31to60amount ,'\N','0') as overdue31to60amount , replace(t1.overdue61to90amount,'\N','0') as overdue61to90amount , replace(t1.overdue91to180amount,'\N','0') as overdue91to180amount , replace(t1.overdueover180amount,'\N','0') as overdueover180amount , replace(t1.latest24state,'\N','') as latest24state , t1.cue , replace(replace(replace(regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'\.([0-9].*?日)'),'年',''),'月',''),'日','') as cue_out_time , coalesce( regexp_substr(replace(replace(replace(substr(t1.cue,1,regexp_instr(t1.cue,'，')),' ',''),' ',''),',',''),'“(.*)”发放'), regexp_substr(replace(replace(replace(substr(t1.cue,1,regexp_instr(t1.cue,'，')),' ',''),' ',''),',',''),'银行(.*)发放'), regexp_substr(replace(replace(replace(substr(t1.cue,1,regexp_instr(t1.cue,'，')),' ',''),' ',''),',',''),'公司(.*)发放'), regexp_substr(replace(replace(replace(substr(t1.cue,1,regexp_instr(t1.cue,'，')),' ',''),' ',''),',',''),'机构(.*)发放'), regexp_substr(replace(replace(replace(substr(t1.cue,1,regexp_instr(t1.cue,'，')),' ',''),' ',''),',',''),'中心(.*)发放') ) as cue_org , regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'发放的*([0-9]+)') as cue_amt, replace(regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'元（(.*?）)'),'）','') as cue_bz, replace(regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'）(.*?，)'),'，','') as cue_amt_zl, replace(regexp_substr(replace(replace(t1.cue,' ',''),' ',''),'业务号(.*?，)'),'，','') as cue_no, replace(regexp_substr(replace(replace(substr(t1.cue,regexp_instr(t1.cue,'，',1,2)+1),' ',''),' ',''),'(.*?，)'),'，','') as cue_db_way , replace(regexp_substr(replace(replace(substr(t1.cue,regexp_instr(t1.cue,'，',1,3)+1),' ',''),' ',''),'(.*?期，)'),'，','') as cue_qs , replace(regexp_substr(replace(replace(substr(t1.cue,regexp_instr(t1.cue,'，',1,3)+1),' ',''),' ',''),'(.*?截至)'),'截至','') cue_gh_way , replace(replace(replace(regexp_substr(replace(replace(replace(t1.cue,' ',''),' ',''),',',''),'截至([0-9].*?日)'),'年',''),'月',''),'日','') as cue_end_time, t.query_time , t2.querydate , t2.queryreason , t2.querier , t1.state , replace(t1.loan_id,'\N',0) as loan_id ,'' AS etl_dt , t1.data_dt FROM (SELECT B.report_sn ,B.global_id,max(replace(replace(substr(B.query_time,1,10),'.',''),'\N','')) as query_time FROM (SELECT A.CERT_NO AS global_id , A.report_sn , A.query_time FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A ) B GROUP BY B.report_sn ,B.global_id ) t LEFT JOIN (SELECT A.REPORT_SN AS row_id , A.CERT_TYPE AS global_type , A.CERT_NO AS global_id , A.REPORT_SN , A.NAME AS customer_name , B.class5state , B.balance , B.remainpaymentcyc , B.scheduledpaymentamount , B.scheduledpaymentdate , B.actualpaymentamount , B.recentpaydate , B.curroverduecyc , B.curroverdueamount , B.overdue31to60amount , B.overdue61to90amount , B.overdue91to180amount , B.overdueover180amount , B.LATEST24STATE AS latest24state , B.cue , B.state , B.loan_id , A.QUERY_TIME AS data_dt FROM (SELECT T1.* FROM (SELECT T.*, ROW_NUMBER() over(PARTITION BY T.REPORT_SN ORDER BY T.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO T ) T1 WHERE T1.sq=1 ) A LEFT JOIN TBL_PER_LOAN_INFO B ON A.REPORT_SN = B.REPORT_ID WHERE B.STATE <>'结清' ) T1 on t.report_sn=t1.row_id left join (SELECT A.CERT_NO AS global_id , A.REPORT_SN , replace(replace(substr(B.querydate,1,10),'.',''),'\N','') as querydate , replace(B.queryreason,'\N','') as queryreason , replace(B.querier,'\N','') as querier FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A LEFT JOIN (SELECT TT1.* FROM (SELECT TT.* , ROW_NUMBER() over(PARTITION BY TT.REPORT_ID ORDER BY TT.querydate DESC ) sq FROM TBL_PER_RECORDDETAIL TT ) TT1 WHERE TT1.sq=1 ) B ON A.REPORT_SN = B.REPORT_ID ) T2 on t.report_sn=t2.report_sn where t.report_sn is not null ; 
insert into hdm_wbd_zx_qry_tblperrecorddetail_new( row_id, global_type, global_id, customer_name, report_id, querydate, query_time, queryreason, querier, etl_dt, data_dt ) select t.row_id, t.global_type, t.global_id, t.customer_name, t.report_id, replace(replace(substr(t.querydate,1,10),'.',''),'\N','') as querydate, t2.query_time, replace(t.queryreason,'\N','') as queryreason, replace(t.querier,'\N','') as querier, '' AS etl_dt, t.data_dt from (SELECT A.REPORT_SN AS row_id , A.CERT_TYPE AS global_type , A.CERT_NO AS global_id , A.NAME AS customer_name , B.report_id , B.querydate , B.queryreason , B.querier , A.QUERY_TIME AS data_dt FROM (SELECT TT1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) TT1 WHERE TT1.sq=1 ) A LEFT JOIN (SELECT TT1.* FROM (SELECT TT.* , ROW_NUMBER() over(PARTITION BY TT.REPORT_ID ORDER BY TT.querydate DESC ) sq FROM TBL_PER_RECORDDETAIL TT ) TT1 WHERE TT1.sq=1 ) B ON A.REPORT_SN = B.REPORT_ID ) T left join (SELECT A.CERT_NO AS global_id , A.REPORT_SN , replace(replace(substr(A.query_time,1,10),'.',''),'\N','') as query_time FROM (SELECT T1.* FROM (SELECT TT.*, ROW_NUMBER() over(PARTITION BY TT.REPORT_SN ORDER BY TT.QUERY_TIME DESC ) sq FROM TBL_PER_RESULT_INFO TT ) T1 WHERE T1.sq=1 ) A ) t2 on t.row_id = t2.REPORT_SN where t.row_id is not null ;
DROP TABLE HDM_WBD_ZX_QRY_TBLPBOCLOANCARDINFO_ALL ;
DROP TABLE HDM_WBD_ZX_QRY_TBLPBOCLOANCARDINFO_CUE; 
DROP TABLE HDM_WBD_ZX_QRY_TBLPBOCLOANINFO_ALL  ;
DROP TABLE HDM_WBD_ZX_QRY_TBLPBOCLOANINFO_CUE ;
DROP TABLE HDM_WBD_ZX_QRY_TBLPERRECORDDETAIL_NEW  ;
DROP TABLE TBL_PER_ADMINPUNISHMENT ;
DROP TABLE TBL_PER_CIVILJUDGEMENT ;
DROP TABLE TBL_PER_CRE_PB_RF_INFO ;
DROP TABLE TBL_PER_INFO_SUMARRY;
DROP TABLE TBL_PER_LOAN_CARD_INFO;
DROP TABLE TBL_PER_LOAN_INFO;
DROP TABLE TBL_PER_PERSIONAL_INFO;
DROP TABLE TBL_PER_PROFESSIONAL;
DROP TABLE TBL_PER_QUERYRECORDCOLLECT;
DROP TABLE TBL_PER_RECORDDETAIL;
DROP TABLE TBL_PER_RECORDDETAIL; 